{"version":3,"file":"index.js","mappings":"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","sources":["webpack://lib/webpack/universalModuleDefinition","webpack://lib/external umd \"react\"","webpack://lib/webpack/bootstrap","webpack://lib/webpack/runtime/compat get default export","webpack://lib/webpack/runtime/define property getters","webpack://lib/webpack/runtime/hasOwnProperty shorthand","webpack://lib/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"lib\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"lib\"] = factory(root[\"react\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__156__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__156__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import React from 'react';\r\nimport './index.css';\r\n\r\n// 防抖函数:在视口大小频繁变动时只执行最后一次变化引起的缩放\r\nconst debounce = (fn, delay) => {\r\n  let delays = delay || 500;\r\n  let timer;\r\n  return function () {\r\n    let th = this;\r\n    let args = arguments;\r\n    if (timer) {\r\n      clearTimeout(timer);\r\n    }\r\n    timer = setTimeout(function () {\r\n      timer = null;\r\n      fn.apply(th, args);\r\n    }, delays);\r\n  };\r\n  }\r\nclass ScaleBox extends React.Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      scale: 1,\r\n      boxObserver: null,\r\n    };\r\n    this.changeScale = debounce((e) => {\r\n      const scale = this.getScale(e);\r\n      this.setState({ scale })\r\n    }, 500)\r\n  }\r\n  // 优先级：container > window(isFullScreen)\r\n  componentDidMount(){\r\n    const { container, isFullScreen } = this.props;\r\n    if(container){\r\n      // 只要传递了container就使用该容器的宽高\r\n      const boxObserver = new ResizeObserver(this.changeScale);\r\n      boxObserver.observe(container);\r\n      this.setState({ boxObserver })\r\n    }else if(isFullScreen){\r\n      // 如果是全屏就使用视口宽高\r\n      this.changeScale();\r\n      window.addEventListener('resize', this.changeScale)\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps){\r\n    // 处理业务需求的多样导致的缩放失效问题\r\n\t\tconst { container:oldContainerValue, isFullScreen: oldIsFullScreen } = prevProps;\r\n\t\tconst { container, isFullScreen } = this.props;\r\n    // 如果更新后传递了container就加上尺寸监控\r\n\t\tif(!oldContainerValue && container){\r\n\t\t\tconst boxObserver = new ResizeObserver(this.changeScale);\r\n\t\t\tboxObserver.observe(container);\r\n      this.setState({ boxObserver });\r\n      // 去掉视口尺寸监控\r\n      window.removeEventListener('resize', this.changeScale)\r\n      return;\r\n\t\t}\r\n    // 如果去掉了isFullScreent，就去掉视口监控\r\n    if(oldIsFullScreen && !isFullScreen){\r\n      window.removeEventListener('resize', this.changeScale)\r\n    }\r\n    // 如果加上了了isFullScreent，就加上视口监控\r\n    if(!oldIsFullScreen && isFullScreen && !container){\r\n      this.changeScale();\r\n      window.addEventListener('resize', this.changeScale)\r\n    }\r\n\t}\r\n\r\n  componentWillUnmount(){\r\n    const { props: { isFullScreen }, state: { boxObserver } } = this;\r\n    if(isFullScreen){\r\n      window.removeEventListener('resize', this.changeScale)\r\n    }else if(boxObserver){\r\n      boxObserver.unobserve();\r\n    }\r\n  }\r\n\r\n  getScale(e) {\r\n    const {width, height} = this.props;\r\n    // 拿到元素style.width实际的宽度是不可行的，直接再resizeObser里拿可以吗？\r\n    let ww,wh;\r\n    if(!e || (e && e.constructor === Event)){\r\n      // 说明没有传container\r\n      ww = window.innerWidth / width;\r\n      wh = window.innerHeight / height;\r\n    }else{\r\n    const {width: currentWidth, height: currentHeight} = e[0].contentRect;\r\n      ww = currentWidth / width;\r\n      wh = currentHeight / height;\r\n    }\r\n\t\treturn ww < wh ? ww : wh\r\n\t}\r\n\r\n  render(){\r\n    const { props: { isFullScreen, container, width, height, children, ...argProps }, state: { scale } } = this;\r\n\r\n    return <div className=\"ry-scale-box\"\r\n\t\t\tstyle={{\r\n        position: !container ? 'fixed' : 'relative',\r\n\t\t\t\ttransform: `scale(${scale}) translate(-50%, -50%)`,\r\n\t\t\t\tWebkitTransform: `scale(${scale}) translate(-50%, -50%)`,\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t}}\r\n      {...argProps}>\r\n\t\t\t{children ? children : null}\r\n\t\t</div>\r\n  }\r\n}\r\n\r\nexport default ScaleBox"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__156__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","_React$Component","_inherits","ScaleBox","_super","props","_this","fn","timer","_classCallCheck","state","scale","boxObserver","changeScale","e","getScale","setState","th","this","args","arguments","clearTimeout","setTimeout","apply","value","_this$props","container","isFullScreen","ResizeObserver","observe","window","addEventListener","prevProps","oldContainerValue","oldIsFullScreen","_this$props2","removeEventListener","unobserve","ww","wh","_this$props3","width","height","constructor","Event","innerWidth","innerHeight","_e$0$contentRect","contentRect","_this$props4","children","argProps","_objectWithoutProperties","_excluded","React","_extends","className","style","position","transform","concat","WebkitTransform"],"sourceRoot":""}